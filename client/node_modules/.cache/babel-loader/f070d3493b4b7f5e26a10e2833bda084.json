{"ast":null,"code":"import _classCallCheck from \"C:\\\\Users\\\\ducbang\\\\Desktop\\\\12345\\\\employee\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:\\\\Users\\\\ducbang\\\\Desktop\\\\12345\\\\employee\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"C:\\\\Users\\\\ducbang\\\\Desktop\\\\12345\\\\employee\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"C:\\\\Users\\\\ducbang\\\\Desktop\\\\12345\\\\employee\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"C:\\\\Users\\\\ducbang\\\\Desktop\\\\12345\\\\employee\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"C:\\\\Users\\\\ducbang\\\\Desktop\\\\12345\\\\employee\\\\client\\\\src\\\\app\\\\auth\\\\AuthGuard.jsx\";\nimport React, { Component, Fragment } from \"react\";\nimport { withRouter } from \"react-router-dom\";\nimport { connect } from \"react-redux\";\nimport AppContext from \"app/appContext\";\nimport ConstantList from \"../appConfig\";\n\nvar AuthGuard = /*#__PURE__*/function (_Component) {\n  _inherits(AuthGuard, _Component);\n\n  function AuthGuard(props, context) {\n    var _this;\n\n    _classCallCheck(this, AuthGuard);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(AuthGuard).call(this, props));\n    var routes = context.routes;\n    _this.state = {\n      authenticated: true,\n      routes: routes\n    };\n    return _this;\n  }\n\n  _createClass(AuthGuard, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {// if (!this.state.authenticated) {\n      //   this.redirectRoute(this.props);\n      // }\n    }\n  }, {\n    key: \"componentDidUpdate\",\n    value: function componentDidUpdate() {// if (!this.state.authenticated) {\n      //   this.redirectRoute(this.props);\n      // }\n    }\n  }, {\n    key: \"shouldComponentUpdate\",\n    value: function shouldComponentUpdate(nextProps, nextState) {// return nextState.authenticated !== this.state.authenticated;\n    }\n  }, {\n    key: \"redirectRoute\",\n    value: function redirectRoute(props) {\n      var location = props.location,\n          history = props.history;\n      var pathname = location.pathname;\n      history.push({\n        //pathname: ConstantList.ROOT_PATH + \"session/signin\",\n        pathname: ConstantList.HOME_PAGE,\n        state: {\n          redirectUrl: pathname\n        }\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var children = this.props.children;\n      var authenticated = this.state.authenticated;\n      return /*#__PURE__*/React.createElement(Fragment, {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 62,\n          columnNumber: 13\n        }\n      }, children); //return authenticated ? <Fragment>{children}</Fragment> : null;\n    }\n  }], [{\n    key: \"getDerivedStateFromProps\",\n    value: function getDerivedStateFromProps(props, state) {\n      var location = props.location,\n          user = props.user;\n      var pathname = location.pathname;\n      var matched = state.routes.find(function (r) {\n        return r.path === pathname;\n      });\n      var authenticated = matched && matched.auth && matched.auth.length ? matched.auth.includes(user.role) : true;\n      return {\n        authenticated: authenticated\n      };\n    }\n  }]);\n\n  return AuthGuard;\n}(Component);\n\nAuthGuard.contextType = AppContext;\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    user: state.user\n  };\n};\n\nexport default withRouter(connect(mapStateToProps)(AuthGuard));","map":{"version":3,"sources":["C:/Users/ducbang/Desktop/12345/employee/client/src/app/auth/AuthGuard.jsx"],"names":["React","Component","Fragment","withRouter","connect","AppContext","ConstantList","AuthGuard","props","context","routes","state","authenticated","nextProps","nextState","location","history","pathname","push","HOME_PAGE","redirectUrl","children","user","matched","find","r","path","auth","length","includes","role","contextType","mapStateToProps"],"mappings":";;;;;;AAAA,OAAOA,KAAP,IAAgBC,SAAhB,EAA2BC,QAA3B,QAA2C,OAA3C;AACA,SAASC,UAAT,QAA2B,kBAA3B;AACA,SAASC,OAAT,QAAwB,aAAxB;AACA,OAAOC,UAAP,MAAuB,gBAAvB;AACA,OAAOC,YAAP,MAAyB,cAAzB;;IACMC,S;;;AACJ,qBAAYC,KAAZ,EAAmBC,OAAnB,EAA4B;AAAA;;AAAA;;AAC1B,mFAAMD,KAAN;AAD0B,QAEpBE,MAFoB,GAETD,OAFS,CAEpBC,MAFoB;AAI1B,UAAKC,KAAL,GAAa;AACXC,MAAAA,aAAa,EAAE,IADJ;AAEXF,MAAAA,MAAM,EAANA;AAFW,KAAb;AAJ0B;AAQ3B;;;;wCAEmB,CAClB;AACA;AACA;AACD;;;yCAEoB,CACnB;AACA;AACA;AACD;;;0CAEqBG,S,EAAWC,S,EAAW,CAC1C;AACD;;;kCAgBaN,K,EAAO;AAAA,UACXO,QADW,GACWP,KADX,CACXO,QADW;AAAA,UACDC,OADC,GACWR,KADX,CACDQ,OADC;AAAA,UAEXC,QAFW,GAEEF,QAFF,CAEXE,QAFW;AAInBD,MAAAA,OAAO,CAACE,IAAR,CAAa;AACX;AACAD,QAAAA,QAAQ,EAAEX,YAAY,CAACa,SAFZ;AAGXR,QAAAA,KAAK,EAAE;AAAES,UAAAA,WAAW,EAAEH;AAAf;AAHI,OAAb;AAKD;;;6BAEQ;AAAA,UACDI,QADC,GACY,KAAKb,KADjB,CACDa,QADC;AAAA,UAECT,aAFD,GAEmB,KAAKD,KAFxB,CAECC,aAFD;AAIN,0BAAO,oBAAC,QAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SAAWS,QAAX,CAAP,CAJM,CAMP;AACD;;;6CAhC+Bb,K,EAAOG,K,EAAO;AAAA,UACpCI,QADoC,GACjBP,KADiB,CACpCO,QADoC;AAAA,UAC1BO,IAD0B,GACjBd,KADiB,CAC1Bc,IAD0B;AAAA,UAEpCL,QAFoC,GAEvBF,QAFuB,CAEpCE,QAFoC;AAG5C,UAAMM,OAAO,GAAGZ,KAAK,CAACD,MAAN,CAAac,IAAb,CAAkB,UAAAC,CAAC;AAAA,eAAIA,CAAC,CAACC,IAAF,KAAWT,QAAf;AAAA,OAAnB,CAAhB;AACA,UAAML,aAAa,GACjBW,OAAO,IAAIA,OAAO,CAACI,IAAnB,IAA2BJ,OAAO,CAACI,IAAR,CAAaC,MAAxC,GACIL,OAAO,CAACI,IAAR,CAAaE,QAAb,CAAsBP,IAAI,CAACQ,IAA3B,CADJ,GAEI,IAHN;AAKA,aAAO;AACLlB,QAAAA,aAAa,EAAbA;AADK,OAAP;AAGD;;;;EAvCqBX,S;;AA8DxBM,SAAS,CAACwB,WAAV,GAAwB1B,UAAxB;;AAEA,IAAM2B,eAAe,GAAG,SAAlBA,eAAkB,CAAArB,KAAK;AAAA,SAAK;AAChCW,IAAAA,IAAI,EAAEX,KAAK,CAACW;AADoB,GAAL;AAAA,CAA7B;;AAIA,eAAenB,UAAU,CAACC,OAAO,CAAC4B,eAAD,CAAP,CAAyBzB,SAAzB,CAAD,CAAzB","sourcesContent":["import React, { Component, Fragment } from \"react\";\r\nimport { withRouter } from \"react-router-dom\";\r\nimport { connect } from \"react-redux\";\r\nimport AppContext from \"app/appContext\";\r\nimport ConstantList from \"../appConfig\";\r\nclass AuthGuard extends Component {\r\n  constructor(props, context) {\r\n    super(props);\r\n    let { routes } = context;\r\n\r\n    this.state = {\r\n      authenticated: true,\r\n      routes\r\n    };\r\n  }\r\n\r\n  componentDidMount() {\r\n    // if (!this.state.authenticated) {\r\n    //   this.redirectRoute(this.props);\r\n    // }\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    // if (!this.state.authenticated) {\r\n    //   this.redirectRoute(this.props);\r\n    // }\r\n  }\r\n\r\n  shouldComponentUpdate(nextProps, nextState) {\r\n    // return nextState.authenticated !== this.state.authenticated;\r\n  }\r\n\r\n  static getDerivedStateFromProps(props, state) {\r\n    const { location, user } = props;\r\n    const { pathname } = location;\r\n    const matched = state.routes.find(r => r.path === pathname);\r\n    const authenticated =\r\n      matched && matched.auth && matched.auth.length\r\n        ? matched.auth.includes(user.role)\r\n        : true;\r\n\r\n    return {\r\n      authenticated\r\n    };\r\n  }\r\n\r\n  redirectRoute(props) {\r\n    const { location, history } = props;\r\n    const { pathname } = location;\r\n\r\n    history.push({\r\n      //pathname: ConstantList.ROOT_PATH + \"session/signin\",\r\n      pathname: ConstantList.HOME_PAGE,\r\n      state: { redirectUrl: pathname }\r\n    });\r\n  }\r\n\r\n  render() {\r\n    let { children } = this.props;\r\n    const { authenticated } = this.state;\r\n\r\n     return <Fragment>{children}</Fragment>;\r\n\r\n    //return authenticated ? <Fragment>{children}</Fragment> : null;\r\n  }\r\n}\r\n\r\nAuthGuard.contextType = AppContext;\r\n\r\nconst mapStateToProps = state => ({\r\n  user: state.user\r\n});\r\n\r\nexport default withRouter(connect(mapStateToProps)(AuthGuard));\r\n"]},"metadata":{},"sourceType":"module"}